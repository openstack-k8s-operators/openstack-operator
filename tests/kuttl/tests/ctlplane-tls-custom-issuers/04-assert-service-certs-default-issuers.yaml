apiVersion: kuttl.dev/v1beta1
kind: TestAssert
timeout: 800
commands:
  - script: |
      echo "Waiting for OpenStack control plane to be ready..."
      oc wait openstackcontrolplane -n $NAMESPACE --for=condition=Ready --timeout=700s -l core.openstack.org/openstackcontrolplane

  - script: |
      echo "Checking issuer of internal certificates..."
      oc exec -i openstackclient -n $NAMESPACE -- bash -s < ../../common/osp_check_cert_issuer.sh "issuer=CN=rootca-internal" "internal"

  - script: |
      echo "Checking issuer of ingress certificates..."
      oc exec -i openstackclient -n $NAMESPACE -- bash -s < ../../common/osp_check_cert_issuer.sh "rootca-public" "public"
